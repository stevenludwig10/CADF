LLalt
dta
k <- grid2[1]
y0 <- grid2[2]
y1 <- grid2[3]
y2 <- grid2[4]
k
grid2 <- c(.5388,.9289,.4865,-1.06,)
grid2 <- c(.5388,.9289,.4865,-1.06)
k <- grid2[1]
y0 <- grid2[2]
y1 <- grid2[3]
y2 <- grid2[4]
k
rec
LLalt = targetBuy * log((y0 + y2 * exp(-1 * y1 * freq)) * k ^ rec) + (1 - targetBuy) * log(1 - (y0 + y2 * exp(-1 * y1 * freq)) * k ^ rec)
LLalt = as.numeric(LLalt)
LLalt
sum(LLalt)
LL2 <- function(rec, freq, targetBuy) {
grid2 <<- grid2
k <- grid2[1]
y0 <- grid2[2]
y1 <- grid2[3]
y2 <- grid2[4]
LLalt = targetBuy * log((y0 + y2 * exp(-1 * y1 * freq)) * k ^ rec) + (1 - targetBuy) * log(1 - (y0 + y2 * exp(-1 * y1 * freq)) * k ^ rec)
LLalt = as.numeric(LLalt)
return(LLalt)
}
LL2 <- function(grid2, rec, freq, targetBuy) {
k <- grid2[1]
y0 <- grid2[2]
y1 <- grid2[3]
y2 <- grid2[4]
LLalt = targetBuy * log((y0 + y2 * exp(-1 * y1 * freq)) * k ^ rec) + (1 - targetBuy) * log(1 - (y0 + y2 * exp(-1 * y1 * freq)) * k ^ rec)
LLalt = as.numeric(LLalt)
return(sum(LLalt))
}
rm(mod_gam)
detach("CADF")
detach(CADF)
library(CADF)
library(CADF)
cadf
library(CADF)
library(CADF)
renv::activate()
library(CADF)
head(ltv.transactions)
create_purchase_string
rm(cadf)
library(CADF)
library(CADF)
library(CADF)
cadf
f_CustomerModelingMatrix
f_CustomerModelingMatrix()
devtools::document()
devtools::load_all(".")
CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
grid2 <- c(.5388,.9289,.4865,-1.06)
rec <- as.numeric(floor(dta$recency.studyperiod.years))
head(ltv.transactions)
data("ltv.transactions")
data("ltv.transactions")
head(ltv.transactions)
a <- split(ltv.transactions, ltv.transactions$ID)
today <- as.Date("8/31/2020", '%m/%d/%Y')
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
dta <- lapply(cadf.data, function(x) tail(x$data, 1))
dta <- do.call(rbind, dta)
grid2 <- c(0,0,0,0)
grid2 <- c(.5388,.9289,.4865,-1.06)
rec <- as.numeric(floor(dta$recency.studyperiod.years))
freq <- dta$Frequency
targetBuy = as.numeric(dta$target.buy)
CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
freq
grid[3]
grid2 * freq
plot(grid2[[3]])
plot(grid2[[3]]* freq)
log(10)
data("ltv.transactions")
head(ltv.transactions)
a <- split(ltv.transactions, ltv.transactions$ID)
today <- as.Date("8/31/2020", '%m/%d/%Y')
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
dta <- lapply(cadf.data, function(x) tail(x$data, 1))
dta <- do.call(rbind, dta)
grid2 <- c(0,0,0,0)
grid2 <- c(.5388,.9289,.4865,-1.06)
rec <- as.numeric(floor(dta$recency.studyperiod.years))
freq <- dta$Frequency
targetBuy = as.numeric(dta$target.buy)
CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
grid2
data("ltv.transactions")
head(ltv.transactions)
a <- split(ltv.transactions, ltv.transactions$ID)
today <- as.Date("8/31/2020", '%m/%d/%Y')
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
dta <- lapply(cadf.data, function(x) tail(x$data, 1))
dta <- do.call(rbind, dta)
grid2 <- c(0,0,0,0)
grid2 <- c(.5388,.9289,.4865,-1.06)
rec <- as.numeric(floor(dta$recency.studyperiod.years))
freq <- dta$Frequency
targetBuy = as.numeric(dta$target.buy)
CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
data("ltv.transactions")
head(ltv.transactions)
a <- split(ltv.transactions, ltv.transactions$ID)
today <- as.Date("8/31/2020", '%m/%d/%Y')
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
dta <- lapply(cadf.data, function(x) tail(x$data, 1))
dta <- do.call(rbind, dta)
grid2 <- c(0,0,0,0)
grid2 <- c(.5388,.9289,.4865,-1.06)
rec <- as.numeric(floor(dta$recency.studyperiod.years))
freq <- dta$Frequency
targetBuy = as.numeric(dta$target.buy)
CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
data("ltv.transactions")
head(ltv.transactions)
a <- split(ltv.transactions, ltv.transactions$ID)
today <- as.Date("8/31/2020", '%m/%d/%Y')
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
dta <- lapply(cadf.data, function(x) tail(x$data, 1))
dta <- do.call(rbind, dta)
grid2 <- c(0,0,0,0)
grid2 <- c(.5388,.9289,.4865,-1.06)
rec <- as.numeric(floor(dta$recency.studyperiod.years))
freq <- dta$Frequency
targetBuy = as.numeric(dta$target.buy)
CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
data("ltv.transactions")
head(ltv.transactions)
a <- split(ltv.transactions, ltv.transactions$ID)
today <- as.Date("8/31/2020", '%m/%d/%Y')
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
dta <- lapply(cadf.data, function(x) tail(x$data, 1))
dta <- do.call(rbind, dta)
grid2 <- c(0,0,0,0)
grid2 <- c(.5388,.9289,.4865,-1.06)
rec <- as.numeric(floor(dta$recency.studyperiod.years))
freq <- dta$Frequency
targetBuy = as.numeric(dta$target.buy)
CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
sum(freq)
rec <- as.numeric(floor(dta$recency.studyperiod.years))
freq <- dta$Frequency.baseperiod
targetBuy = as.numeric(dta$target.buy)
freq
sum(freq)
CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
res <- CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
sum(res)
res <- ifelse(res > 1, 1, res)
res <- ifelse(res < 0, 0, res)
sum(res)
res
rec
grid2
res <- CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
res
sum(res)
res <- CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
res
sum(res)
res <- ifelse(res <0, 0, res)
res <- ifelse(res > 1, 1, res)
sum(res)
sum(freq)
sum(rec)
data("ltv.transactions")
head(ltv.transactions)
a <- split(ltv.transactions, ltv.transactions$ID)
today <- as.Date("8/31/2020", '%m/%d/%Y')
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
dta <- lapply(cadf.data, function(x) tail(x$data, 1))
dta <- do.call(rbind, dta)
grid2 <- c(0,0,0,0)
grid2 <- c(.5388,.9289,.4865,-1.06)
rec <- as.numeric(floor(dta$recency.studyperiod.years))
freq <- dta$Frequency.baseperiod
targetBuy = as.numeric(dta$target.buy)
sum(freq)
res <- CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
res
sum(res)
rec <- dta$recency.studyperiod.years
sum(rec)
rec <- as.numeric(dta$recency.studyperiod.years)
freq <- dta$Frequency.baseperiod
targetBuy = as.numeric(dta$target.buy)
sum(rec)
res <- CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
res
sum(res)
sum(rec)
sum(targetBuy)
targetBuy
as.character(dta$target.buy)
rec <- as.numeric(dta$recency.studyperiod.years)
freq <- dta$Frequency.baseperiod
targetBuy = as.numeric(as.character(dta$target.buy))
sum(targetBuy)
res <- CADF::modeling.annualhalfing.likelihood(grid2, rec, freq, targetBuy)
sum(res)
?mle
library(stats4)
mle
?mle
mle(CADF::modeling.annualhalfing.likelihood)
ll2 <- function(ymax = 15, xhalf = 6)
-sum(stats::dpois(y, lambda = ymax/(1+x/xhalf), log = TRUE))
mle(ll2, lower = rep(0, 2))
mle(CADF::modeling.annualhalfing.likelihood, grid2)
grid2
model<- nlminb(CADF::modeling.annualhalfing.likelihood(), start=grid2, upper=c(1,1,Inf,Inf), lower=c(0,0,-Inf,-Inf), control=list(iter.max = 200))
model<- nlminb(CADF::modeling.annualhalfing.likelihood, start=grid2, upper=c(1,1,Inf,Inf), lower=c(0,0,-Inf,-Inf), control=list(iter.max = 200))
?nlminb
model<- nlminb(CADF::modeling.annualhalfing.likelihood, start=grid2,
upper=c(1,1,Inf,Inf), lower=c(0,0,-Inf,-Inf), control=list(iter.max = 200), rec=rec, freq=freq, targetBuy = targetBuy)
model
grid2 <- c(.5,.5,.5,-1)
model<- nlminb(CADF::modeling.annualhalfing.likelihood, start=grid2,
upper=c(1,1,Inf,Inf), lower=c(0,0,-Inf,-Inf), control=list(iter.max = 200), rec=rec, freq=freq, targetBuy = targetBuy)
warnings()
model
grid2 <- c(.5, .9, .2, -.9 )
grid2 <- c(.5, .9, .2, -.9 )
model
model<- nlminb(CADF::modeling.annualhalfing.likelihood, start=grid2,
upper=c(1,1,Inf,Inf), lower=c(0,0,-Inf,-Inf), control=list(iter.max = 200), rec=rec, freq=freq, targetBuy = targetBuy, eval.max=400)
model<- nlminb(CADF::modeling.annualhalfing.likelihood, start=grid2,
upper=c(1,1,Inf,Inf), lower=c(0,0,-Inf,-Inf), control=list(iter.max = 200), rec=rec, freq=freq, targetBuy = targetBuy, control=list(eval.max=400))
upper=c(1,1,Inf,Inf), lower=c(0,0,-Inf,-Inf), control=list(iter.max = 200, eval.max=400), rec=rec, freq=freq, targetBuy = targetBuy)
model<- nlminb(CADF::modeling.annualhalfing.likelihood, start=grid2,
upper=c(1,1,Inf,Inf), lower=c(0,0,-Inf,-Inf), control=list(eval.max=400), rec=rec, freq=freq, targetBuy = targetBuy)
model
grid2
model<- nlminb(CADF::modeling.annualhalfing.likelihood, start=grid2,
upper=c(1,1,Inf,Inf), lower=c(0,0,-Inf,-Inf), control=list(eval.max=900), rec=rec, freq=freq, targetBuy = targetBuy)
model
uniroot
uniroot(CADF::modeling.annualhalfing.likelihood)
uniroot(CADF::modeling.annualhalfing.likelihood)
model
list(eval.max = 900, test=4)
?optim
optim(grid2, CADF::modeling.annualhalfing.likelihood)
optim(grid2, CADF::modeling.annualhalfing.likelihood, rec=rec, freq=freq, targetBuy=targetBuy)
optim(grid2, CADF::modeling.annualhalfing.likelihood, rec=rec, freq=freq, targetBuy=targetBuy)
options(scipen=10)
optim(grid2, CADF::modeling.annualhalfing.likelihood, rec=rec, freq=freq, targetBuy=targetBuy)
grid2
options(scipen=20)
optim(grid2, CADF::modeling.annualhalfing.likelihood, rec=rec, freq=freq, targetBuy=targetBuy)
grid2
warnings()
?optim
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
library(BTYD)
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
data("cdnowElog")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
head(cdnowElog)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d");
elog[1:3,]
elog <- BTYD::dc.MergeTransactionsOnSameDate(elog);
end.of.cal.period <- as.Date("1997-09-30")
elog.cal <- elog[which(elog$date <= end.of.cal.period), ]
split.data <- dc.SplitUpElogForRepeatTrans(elog.cal);
clean.elog <- split.data$repeat.trans.elog;
freq.cbt <- BTYD::dc.CreateFreqCBT(clean.elog);
freq.cbt[1:3,1:5]
tot.cbt <- BTYD::dc.CreateFreqCBT(elog)
cal.cbt <- BTYD::dc.MergeCustomers(tot.cbt, freq.cbt)
birth.periods <- split.data$cust.data$birth.per
last.dates <- split.data$cust.data$last.date
cal.cbs.dates <- data.frame(birth.periods, last.dates,
end.of.cal.period)
head(cal.cbs.dates)
cal.cbs <- BTYD::dc.BuildCBSFromCBTAndDates(cal.cbt, cal.cbs.dates,
per="week")
head(cal.cbs)
head(elog)
head(transactions)
data("transactions")
head(transactions)
head(ltv.transactions)
data(transactions)
a <- split(transactions, transactions$ID)
a <- Filter(function(x) nrow(x) > 1, a) #repeat-purchaser
cadf.data <- lapply(a, function(x) CADF::Customer$new(x))
data("ltv.transactions")
head(ltv.transactions)
a <- split(ltv.transactions, ltv.transactions$ID)
today <- as.Date("8/31/2020", '%m/%d/%Y')
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
head(ltv.transactions)
head(elog)
a <- split(elog, elog$cust)
head(a)
head(elog)
str(elog)
min(elog$date)
max(elog$date)
max(elog$date) - min(elog$date)
mid <- max(elog$date) - min(elog$date)
mid
mid/2
mid <- max(elog$date) - min(elog$date)
mid
today <- min(elog$date) + mid/2
today
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
mid <- max(elog$date) - min(elog$date)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
head(elog)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
head(elog)
str(elog)
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
a <- split(elog, elog$cust)
a
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
df_customer$frequency.holdout
ls
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
a <- split(elog, elog$cust)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
a <- split(elog, elog$cust)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
head(df_customer)
today
data("ltv.transactions")
head(ltv.transactions)
a <- split(ltv.transactions, ltv.transactions$ID)
colnames(elog) <- c("ID", "PURCHASE_DATE")
head(elog)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
warnings()
modelingdata <- CADF::CADF_to_btyd_pareto_nbd(cadf.data)
head(modelingdata)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
colnames(elog) <- c("ID", "PURCHASE_DATE")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
a <- split(elog, elog$ID)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
colnames(elog) <- c("ID", "PURCHASE_DATE")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
a <- split(elog, elog$ID)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
colnames(elog) <- c("ID", "PURCHASE_DATE")
a <- split(elog, elog$ID)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
colnames(elog) <- c("ID", "PURCHASE_DATE")
a <- split(elog, elog$ID)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
modelingdata <- CADF::CADF_to_btyd_pareto_nbd(cadf.data)
head(modelingdata)
head(cal.cbs)
head(modelingdata)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
colnames(elog) <- c("ID", "PURCHASE_DATE")
a <- split(elog, elog$ID)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
cadf.data[[1]]
cadf.data[[1]]$data
modelingdata <- CADF::CADF_to_btyd_pareto_nbd(cadf.data)
head(modelingdata)
library(CADF)
modelingdata <- CADF::CADF_to_btyd_pareto_nbd(cadf.data)
head(modelingdata)
head(cal.cbs)
library(CADF)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
colnames(elog) <- c("ID", "PURCHASE_DATE")
a <- split(elog, elog$ID)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
colnames(elog) <- c("ID", "PURCHASE_DATE")
a <- split(elog, elog$ID)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
today
str(today)
min(df_customer[[2]])
head(df_customer)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
colnames(elog) <- c("ID", "PURCHASE_DATE")
a <- split(elog, elog$ID)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
colnames(elog) <- c("ID", "PURCHASE_DATE")
a <- split(elog, elog$ID)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
df_customer
today
library(CADF)
library(CADF)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
colnames(elog) <- c("ID", "PURCHASE_DATE")
a <- split(elog, elog$ID)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
modelingdata <- CADF::CADF_to_btyd_pareto_nbd(cadf.data)
modelingdata
today
min(elog)
head(elog)
min(elog$PURCHASE_DATE)
today - min(elog$PURCHASE_DATE)
272/30
272/7
library(CADF)
cdnowElog <- system.file("data/cdnowElog.csv", package = "BTYD")
elog <- BTYD::dc.ReadLines(cdnowElog, cust.idx = 2,
date.idx = 3, sales.idx = 5)
elog$date <- as.Date(elog$date, "%Y%m%d")
mid <- max(elog$date) - min(elog$date)
today <- min(elog$date) + mid/2
colnames(elog) <- c("ID", "PURCHASE_DATE")
a <- split(elog, elog$ID)
cadf.data <- lapply(a, function(x) CADF::Customer$new(x, today=today))
modelingdata <- CADF::CADF_to_btyd_pareto_nbd(cadf.data)
head(modelingdata)
